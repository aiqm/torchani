import math
from torchani.constants import PERIODIC_TABLE

# data extracted from Grimme et. al. paper
# https://pubs.acs.org/doi/10.1021/acs.jctc.8b01176
_data = """H 0.405771 0.08 2.213717 1.105388 0.0556389 0.00027431 1.4 1.0
He 0.642029 0.2 3.604670 1.094283 -0.01 -0.00337528 3.0 1.0
Li 0.245006 0.130382 0.475307 1.289367 -0.005 0.0002 5.0
Be 0.684789 0.0574239 0.939696 4.221216 -0.00613341 -0.00058586 5.0
B 0.513556 0.0946104 1.373856 7.192431 -0.00481186 -0.00058228 5.0
C 0.538015 0.15 1.247655 4.231078 -0.00411674 0.00213583 3.0 3.0
N 0.461493 -0.063978 1.682689 5.242592 0.0352127 0.0202679 1.9 3.0
O 0.451896 -0.0517134 2.165712 5.784415 -0.0493567 -0.00310828 1.8 2.0
F 0.531518 0.142621 2.421394 7.021486 -0.0833918 -0.00245955 2.4 1.0
Ne 0.850000 0.05 3.318479 11.041068 0.1 -0.005 5.0
Na 0.271056 0.179873 0.572728 5.244917 0 0.0002 5.0
Mg 0.344822 0.234916 0.917975 18.083164 -0.00082005 -0.00005516 5.0
Al 0.364801 0.14 0.876623 17.867328 0.0263334 -0.00021887 5.0
Si 0.720000 0.193629 1.187323 40.001111 -0.0002575 -0.0008 3.9 3.0
P 0.297739 0.0711291 1.143343 19.683502 0.0211022 0.00028679 2.1 3.0
S 0.339971 -0.0501722 1.214553 14.995090 -0.00151117 0.00442859 3.1 3.0
Cl 0.248514 0.149548 1.577144 17.353134 -0.0253696 0.00122783 2.5 1.0
Ar 0.502376 -0.0315455 0.896198 7.266606 -0.0207733 -0.010834 5.0
K 0.247602 0.203309 0.482206 10.439482 -0.00103383 0.00025 5.0
Ca 0.320378 0.20069 0.683051 14.786701 -0.00236675 0.0001 5.0
Sc 0.472633 0.05 0.574299 8.004267 -0.00515177 -0.00042004 5.0
Ti 0.513586 0.176727 0.723104 12.036336 -0.00434506 0.0005966 5.0
V 0.589187 0.09 0.928532 15.677873 -0.0035 0.00009764 5.0
Cr 0.396299 0.03 0.966993 19.517914 0.00149669 0.00137744 5.0
Mn 0.346651 0.06 1.071100 18.760605 -0.00759168 0.00229903 5.0
Fe 0.271594 -0.05 1.113422 20.360089 0.00412929 0.00267734 5.0
Co 0.477760 0.03 1.241717 27.127744 -0.00247938 0.00048237 5.0
Ni 0.344970 -0.02 1.077516 10.533269 -0.0126189 -0.0008 5.0
Cu 0.202969 0.05 0.998768 9.913846 -0.007 -0.00345631 5.0
Zn 0.564152 0.23129 1.160262 22.099503 -0.001 0.00007658 5.0
Ga 0.432236 0.233427 1.122923 31.146750 0.00267219 -0.00003616 5.0
Ge 0.802051 -0.0064775 1.222349 42.100144 0.0010846 -0.00003589 5.0
As 0.571748 0.110604 1.249372 39.147587 -0.00201294 0.00014149 5.0
Se 0.235052 0.0913725 1.230284 27.426779 -0.00288648 0.00085728 3.9 3.0
Br 0.261253 0.13 1.296174 32.845361 -0.0108859 0.00216935 4.0 1.0
Kr 0.424373 0.0239815 0.908074 17.363803 -0.00889357 -0.00415024 5.0
Rb 0.210481 0.29162 0.574054 44.338211 -0.00093328 0.00015 5.0
Sr 0.340000 0.18 0.697345 34.365525 -0.00459925 0.00015 5.0
Y 0.711958 0.01 0.706172 17.326237 -0.00637291 0.0001046 5.0
Zr 0.461440 0.07 0.681106 24.263093 -0.00599615 -0.00012944 5.0
Nb 0.952957 0.05 0.865552 30.562732 -0.00288729 0.00041491 5.0
Mo 0.586134 0.0919928 1.034519 48.312796 0.00346327 0.00312549 5.0
Tc 0.368054 0.06 1.019565 44.779882 -0.00458416 0.00155242 5.0
Ru 0.711205 -0.05 1.031669 28.070247 -0.00081922 0.00359228 5.0
Rh 0.509183 0.03 1.094599 38.035941 0.00007016 0.0000857 5.0
Pd 0.273310 0.08 1.092745 28.674700 -0.00310361 -0.00040485 5.0
Ag 0.263740 0.02 0.678344 6.493286 -0.00800314 -0.0002081 5.0
Cd 0.392012 0.207322 0.936236 26.226628 -0.00105364 0.0001225 5.0
In 0.461812 0.19 1.024007 63.854240 0.00951079 -0.00002031 5.0
Sn 0.900000 -0.0178396 1.139959 80.053438 0.00085029 -0.00008243 5.0
Sb 0.942294 0.11 1.122937 77.057560 -0.00015519 -0.0002063 5.0
Te 0.750000 0.0953683 1.000712 48.614745 -0.00263414 -0.00026864 5.0
I 0.383124 0.12 1.017946 63.319176 -0.00603648 0.0006966 5.0
Xe 0.424164 -0.0118925 1.012036 51.188398 -0.00214447 -0.001562 5.0
Cs 0.236569 0.240419 0.585257 67.249039 -0.0008 0.00008 5.0
Ba 0.245937 0.20691 0.716259 46.984607 -0.0026 0.00015 5.0
La 0.597716 0.0012793 0.737643 50.927529 -0.00395198 -0.0003 5.0
Ce 0.662889 -0.01 0.729950 48.676714 -0.00723806 -0.00025 5.0
Pr 0.660710 -0.0100002 0.734624 47.669448 -0.00704819 -0.00024615 5.0
Nd 0.658531 -0.0100004 0.739299 46.662183 -0.00685832 -0.00024231 5.0
Pm 0.656352 -0.0100006 0.743973 45.654917 -0.00666845 -0.00023846 5.0
Sm 0.654173 -0.0100008 0.748648 44.647651 -0.00647858 -0.00023462 5.0
Eu 0.651994 -0.010001 0.753322 43.640385 -0.00628871 -0.00023077 5.0
Gd 0.649815 -0.0100012 0.757996 42.633120 -0.00609884 -0.00022692 5.0
Tb 0.647635 -0.0100013 0.762671 41.625854 -0.00590897 -0.00022308 5.0
Dy 0.645456 -0.0100015 0.767345 40.618588 -0.0057191 -0.00021923 5.0
Ho 0.643277 -0.0100017 0.772020 39.611322 -0.00552923 -0.00021538 5.0
Er 0.641098 -0.0100019 0.776694 38.604057 -0.00533936 -0.00021154 5.0
Tm 0.638919 -0.0100021 0.781368 37.596791 -0.00514949 -0.00020769 5.0
Yb 0.636740 -0.0100023 0.786043 36.589525 -0.00495961 -0.00020385 5.0
Lu 0.634561 -0.0100025 0.790717 35.582259 -0.00476974 -0.0002 5.0
Hf 0.662597 -0.01 0.852852 40.186772 -0.00537685 -0.00016478 5.0
Ta 0.449812 0.02 0.990234 54.666156 -0.00200343 0.00039599 5.0
W 0.685426 -0.02 1.018805 55.899801 0.00065886 0.0106331 5.0
Re 0.224623 0.08 1.170412 80.410086 -0.00587636 0.0030687 5.0
Os 0.364388 0.08 1.221937 62.809871 -0.0051009 0.00759049 5.0
Ir 0.548507 -0.01 1.197148 56.045639 -0.00673822 0.00322935 5.0
Pt 0.353574 0.06 1.204081 53.881425 -0.00423684 0.00098019 5.0
Au 0.438997 0.085 0.919210 14.711475 0.00393418 -0.0002032 5.0
Hg 0.457611 -0.0116312 1.137360 51.577544 -0.0025 -0.00032901 5.0
Tl 0.418841 -0.0533933 1.399312 58.801614 0.00374018 -0.00008506 5.0
Pb 0.168152 0.02 1.179922 102.368258 0.0100702 -0.0000167 5.0
Bi 0.900000 -0.0337508 1.130860 132.896832 -0.00737252 0.00162529 5.0
Po 1.023267 0.187798 0.957939 52.301232 -0.0134485 0.00013818 5.0
At 0.288848 0.184648 0.963878 81.771063 -0.00348123 0.00021624 5.0
Rn 0.303400 0.0097834 0.965577 128.133580 -0.00167597 -0.00111556 5.0""".split(
    "\n"
)
SUPPORTED_REPULSION_ELEMENTS = len(_data)

# first we make sure that all elements are present in the table
all_znumbers = []
for line in _data:
    element, _, _, alpha, y_eff = line.split()[:5]
    all_znumbers.append(PERIODIC_TABLE.index(element))
assert all_znumbers == list(range(1, SUPPORTED_REPULSION_ELEMENTS + 1))

alpha_constants = [math.nan] * (SUPPORTED_REPULSION_ELEMENTS + 1)
y_eff_constants = [math.nan] * (SUPPORTED_REPULSION_ELEMENTS + 1)
for line in _data:
    element, _, _, alpha, y_eff = line.split()[:5]
    # note that the first value is a dummy value actually
    alpha_constants[PERIODIC_TABLE.index(element)] = float(alpha)
    y_eff_constants[PERIODIC_TABLE.index(element)] = float(y_eff)
